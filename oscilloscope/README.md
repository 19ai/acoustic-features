# Oscilloscope GUI

The oscilloscope GUI is for visualizing wavefrom, FFT, spectrogram, MFSCs and MFCCs. Its core software component is "matplotlib" that is superimposed onto Tk. The GUI can also be used to acquire training data for CNN by just pressing a button on the GUI.

Connect PC to the edge device with a USB cable, and run "[run.bat](./run.bat)" to start the oscilloscope GUI:
```
Sound ))) [MEMS mic]--[Edge device(STM32L476RG)]<-- USB serial -->[Oscilloscope GUI (oscilloscope.py)]
```

### Using the oscilloscope GUI to collect data for training CNN

Run "[run_measurement.bat](./run_measurement.bat)" to obtain feature data set for training CNN.

[Step 1] Enter a class label into the class label entry on the GUI.

[Step 2] Press "MFSCs" or "MFCCs" button to check if the edge device can transfer feature data to the GUI.

[Step 3] Press "Confirm" button.

[Step 4] Use cursor keys for data collection:

```
          [Up]
     [Left]   [Right]
         [Down]

Up: fetch feature data from the device
Left: move the window left
Right: move the window right
Down: save the data
```

The window on the screen is highlighted.

# Calibrating MEMS mic and DFSDM

Condition: 7000 Hz sine wave is generated by a tone generator running on my PC, and the MEMS mic receives the tone via air.

## Measurement result

"System clock 80_000_000 / clock divider 32 / FOSR 128" outperformed System "clock 80_000_000 / clock divider 64 / FOSR 64": SNR is better at 7000Hz.

### System clock 80_000_000 / clock divider 64 / FOSR 64

#### Pre-emphasis disabled

![FFT pre-emphasis disabled](./calibration/fft-pre_emphasis_disabled-64-64.png)

#### Pre-emphasis enabled

![FFT pre-emphasis enabled](./calibration/fft-pre_emphasis_enabled-64-64.png)

![Spectrogram pre-emphasis enabled](./calibration/spectrogram-pre_emphasis_enabled-64-64.png)

![Mel-spectrogram pre-emphasis enabled](./calibration/mel_spectrogram-pre_emphasis_enabled-64-64.png)

### System clock 80_000_000 / clock divider 32 / FOSR 128

#### Pre-emphasis disabled

![FFT pre-emphasis disabled](./calibration/fft-pre_emphasis_disabled-32-128.png)

#### Pre-emphasis enabled

![FFT pre-emphasis enabled](./calibration/fft-pre_emphasis_enabled-32-128.png)

![Spectrogram pre-emphasis enabled](./calibration/spectrogram-pre_emphasis_enabled-32-128.png)

![Mel-spectrogram pre-emphasis enabled](./calibration/mel_spectrogram-pre_emphasis_enabled-32-128.png)
